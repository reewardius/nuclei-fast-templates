id: crlf-detection-method

info:
  name: CRLF - Injection Detection Methods
  author: reewardius
  severity: info
  description: CRLF sequences were not properly sanitized.
  reference:
    - https://youtu.be/p1ClNhaoZQ8
  tags: crlf
    
http:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/%20H"
      - "{{BaseURL}}/%20HTTP/13.37%0D%0AX:%20X"
      - "{{BaseURL}}/%20HTTP/1.1%0D%0AHost:%20x"
      - "{{BaseURL}}/%20HTTP/9%0D%0ATransfer-Encoding:%20nonexistant%0D%0Ax-end:%20a"
      
    stop-at-first-match: true
    req-condition: true
    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - status_code_1 == 200 && status_code_2 == 400
          
      - type: dsl
        dsl:
          - status_code_1 == 200 && status_code_3 == 505
          
      - type: dsl
        dsl:
          - status_code_1 == 200 && status_code_4 == 400
          
      - type: dsl
        dsl:
          - status_code_1 == 200
          - status_code_5 == 501 || status_code_5 == 505
        condition: and